!function(){$=jQuery=function(e){var r={};if("string"==typeof e){for(var t=document.querySelectorAll(e),n=0;n<t.length;n++)r[n]=t[n];r.length=t.length}else e instanceof Node&&(r={0:e,length:1});return r.width=function(e){for(var t=[],n=0;n<r.length;n++)e?r[n].setAttribute("width",e):t.push(r[n].offsetWidth);return t[0]+"px"},r.height=function(e){for(var t=[],n=0;n<r.length;n++)e?r[n].setAttribute("height",e):t.push(r[n].offsetHeight);return t[0]+"px"},r.find=function(e){for(var t=[],n=0;n<r.length;n++)t.concat(o(r[n],e));return t},r.parent=function(){return r[0].parentNode},r.getAttribute=function(e){return r[0].getAttribute(e)},r.setAttribute=function(e,t){return r[0].setAttribute(e,t),r[0]},0<r.length&&(r.innerHTML=r[0].innerHTML,r.insertBefore=r[0].insertBefore),r.empty=function(){for(var e=r[0].childNodes.length-1;0<=e;e--)r[0].removeChild(r[0].childNodes[e])},r};var r=[];function o(e,t){if(0<e.childNodes.length)for(var n=0;n<e.childNodes.length;n++)o(e.childNodes[n],t);return e.nodeName===t.toUpperCase()&&r.push(e),r}function e(e){var t=e.exportElement,n=e.exportFileName,r=e.StringStyle?e.StringStyle:"#main,\t#main1 {height: 400px;width: 630px\t}\t.list {background: blue;padding: 10px\t}\t.list .page {background: yellow;padding: 5px;height: 20px;\t}\t.img {padding: 50px;\t}\ttable {align-text: center;width: 100%;vertical-align: middle;border-top: 1px solid #ddd;border-left: 1px solid #ddd;\t}\ttable td,\ttable th {width: 20%;height: 40px;border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;\t}\ttable p {text-indent: 0 !important;text-align: center;\t}",o=e.fileParams,i=$("#html-docx-config").innerHTML,a=function(){if(0==$("#html-docx-config").length)return{header:{text:"",align:"right"},footer:!1,content:!1,firstPage:"",titlePg:!1};var e=$("#page-header");document.getElementById("page-header")&&document.getElementById("page-header").setAttribute("data",e.innerHTML);var t=e.innerHTML="";$("#first-page")&&$("#first-page").length&&$("#page-content").length&&(t="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head></head><body>"+$("#first-page").innerHTML.replace(/\s{2,}/g,"")+"</body></html>",$("#first-page").innerHTML="");var n=$("#page-content"),r=document.createElement("br");r.setAttribute("clear","all"),r.setAttribute("style","page-break-before:always"),r.setAttribute("mce_style","page-break-before:always");for(var o=document.getElementsByClassName("change-line"),i=0;i<o.length;i++)o[i].parentNode.insertBefore(r,$(".change-line")[i]);var a=$("#page-footer");return{header:{text:e&&e.getAttribute("data")||"",align:e&&e.getAttribute("textAlign")||"right"},footer:!(!a||!a.length),content:n&&n.length,firstPage:t,titlePg:!(!$("#first-page")||!$("#first-page").length||"true"!==$("#first-page").getAttribute("titlePg"))}}(),d="#temporaryExportElement",l=document.createElement("div");l.setAttribute("id","temporaryExportElement"),document.body.appendChild(l),l.innerHTML=$(t).innerHTML,function(e,t){for(var n=$(e).find("canvas"),r=$(t).find("canvas"),o=0;o<n.length;o++){var i=$(r[o]).parent().parent(),a=n[o].toDataURL("image/jpg");$(i).empty();var d=document.createElement("img");d.setAttribute("src",a),d.setAttribute("width",n[o].width()),d.setAttribute("height",$(n[o]).height()),i.appendChild(d)}}(t,d),function(){var e=document.querySelectorAll("img"),n=document.createElement("canvas"),r=n.getContext("2d");[].forEach.call(e,function(e){var e=new Image;e.setAttribute("crossOrigin","anonymous"),r.clearRect(0,0,n.width,n.height),n.width=e.width,n.height=e.height,r.drawImage(e,0,0);var t=n.toDataURL();e.setAttribute("src",t)}),n.remove()}();var c=o||{},f=["<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head></head><style>"+(r?r.replace(/(\s{2,}|\n)/g,""):"")+"</style><body>"+$(d).innerHTML.replace(/\s{2,}/g,"")+"</body></html>",a.firstPage],u=htmlDocx.asBlob(f,{margins:c.margins,config:a});s(u,n),a.firstPage&&($("#html-docx-config").innerHTML=i),document.getElementById("temporaryExportElement").remove()}var s=s||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(g){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var h=g.document,m=function(){return g.URL||g.webkitURL||g},p=h.createElementNS("http://www.w3.org/1999/xhtml","a"),w=!g.externalHost&&"download"in p,v=g.webkitRequestFileSystem,b=g.requestFileSystem||v||g.mozRequestFileSystem,i=function(e){(g.setImmediate||g.setTimeout)(function(){throw e},0)},y="application/octet-stream",x=0,E=[],e=function(){for(var e=E.length;e--;){var t=E[e];"string"==typeof t?m().revokeObjectURL(t):t.remove()}E.length=0},A=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){i(e)}}},n=function(r,n){var e,o,t,i=this,a=r.type,d=!1,l=function(){var e=m().createObjectURL(r);return E.push(e),e},c=function(){A(i,"writestart progress write writeend".split(" "))},f=function(){!d&&e||(e=l()),o?o.location.href=e:window.open(e,"_blank"),i.readyState=i.DONE,c()},u=function(e){return function(){if(i.readyState!==i.DONE)return e.apply(this,arguments)}},s={create:!0,exclusive:!1};if(i.readyState=i.INIT,n||(n="download"),w)return e=l(),p.href=e,p.download=n,function(e){var t=h.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,g,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}(p),i.readyState=i.DONE,void c();g.chrome&&a&&a!==y&&(t=r.slice||r.webkitSlice,r=t.call(r,0,r.size,y),d=!0),v&&"download"!==n&&(n+=".download"),(a===y||v)&&(o=g),b?(x+=r.size,b(g.TEMPORARY,x,u(function(e){e.root.getDirectory("saved",s,u(function(e){var t=function(){e.getFile(n,s,u(function(n){n.createWriter(u(function(t){t.onwriteend=function(e){o.location.href=n.toURL(),E.push(n),i.readyState=i.DONE,A(i,"writeend",e)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&f()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=i["on"+e]}),t.write(r),i.abort=function(){t.abort(),i.readyState=i.DONE},i.readyState=i.WRITING}),f)}),f)};e.getFile(n,{create:!1},u(function(e){e.remove(),t()}),u(function(e){e.code===e.NOT_FOUND_ERR?t():f()}))}),f)}),f)):f()},t=n.prototype,r=function(e,t){return new n(e,t)};return t.abort=function(){this.readyState=this.DONE,A(this,"abort")},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,g.addEventListener("unload",e,!1),r.unload=function(){e(),g.removeEventListener("unload",e,!1)},r}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=s:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return s}),"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof define&&null!==define&&null!=define.amd?define([],function(){return e}):"undefined"!=typeof window&&(window.HtmlToDocx=e)}();